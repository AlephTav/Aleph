Aleph\\Cache\\Cache
===================



Общая информация
----------------

**Наследование:** нет

**Дочерние классы:** Aleph\\Cache\\File, Aleph\\Cache\\Memory, Aleph\\Cache\\APC

**Интерфейсы:** ArrayAccess, Countable

**Источник:** `lib/cache/cache.php`



Абстрактный класс, являющийся базой всех классов фрэмворка, которые используются
для кэширования данных. Содержит методы для работы с группами кэшируемых данных,
а также фабричный метод, позволяющий получать экземпляр класса кэша заданного
типа.

Благодаря тому, что класс реализует интерфейс ArrayAccess и перегрузку свойств,
есть возможность обращаться к закэшированным данным как к элементам массива или
как к свойствам класса. Пример:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// Сохраняем в кэше данные 'some data' на 10 секунд под идентификатором 'key'
$cache->set('key', 'some data', 10);
// Читаем данные и приписываем к ним символ '!'
$cache->key = $cache['key'] . '!';
// Удаляем данные из кэша
unset($cache['key']);
// Проверяем что данные были удалены
var_dump(isset($cache->key));
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

При этом имя группы кэша и время его жизни остаются неизменными.

>   Если создать кэша не через метод set, а через обращение к элементу массива
>   или свойству класса, то время жизни кэша будет установленно равным значению
>   защищённой переменной `$vaultLifeTime`, а именем группы кэша будет пустая
>   строка.



Общедоступные статические методы
--------------------------------



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public static Aleph\Cache\Cache getInstance(string $type = null, array $params = null)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$type** - тип класса для кэширования.

    -   **$params** - параметры кэша.

Возвращает объект определённого класса кэширования. Для каждого типа кэша
возможна передача его параметров в качестве второго аргумента метода. Ниже
приведён список возможных параметров в зависимости от типа кэша:

1.  Тип **File**:

    -   **directory** - директория кэша. Если такой директории не существует,
        фрэймворк попытается создать её сам.

2.  Тип **Memory**:

    -   **servers** - массив кинфигурационных параметров серверов для memcache.
        Для получения более подробной информации смотри
        [http://php.net/manual/ru/memcache.addserver.php][1]

    -   **compress** - булевый параметр, определяющий будут ли данные сжиматься
        перед помещением в кэш. Значение по умолчанию TRUE.

3.  Тип **APC**. Конфигурационных параметров не имеет.

Если тип кэша не задан, то метод попытается прочитать тип кэша и его параметры
из конфигурационного файла из секции cache. Если секция cache не определенна или
тип кэша не указан в конфигурационном файле, то будет взят тип кэша по умолчанию
- файловый кэш.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public static boolean isAvailable()
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:** нет

Возвращает TRUE, если кэш соотвествующего типа доступ для использования и FALSE
в противном случае.



Общедоступные нестатические методы
----------------------------------



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
abstract public void set(string $key, mixed $content, integer $expire, string $group = '')
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

    -   **$content** - данные подлежащие кэшированию.

    -   **$expire** - время жизни кэша в секундах.

    -   **$group** - имя группы кэша.

Сохраняет данные в кэше по их уникальному идентификатору.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
abstract public mixed get(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает данные сохранённые в кэше по их идентификатору.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
abstract public void remove(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Удаляет данные из кэша по их идентификатору.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
abstract public boolean isExpired(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает TRUE, если время жизни кэша истекло и FALSE в противном случае.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
abstract public void clean()
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:** нет

Удаляет все данные из кэша.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void gc(float $probability = 100)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$probability** - вероятность срабатывания метода.

Запускает с заданной вероятностью чистку просроченных данных кэша. Этот метод
имеет смысл только для типов кэша не имеющих механизмов автоотчистки (например,
для файлового кэша).



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public integer count()
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:** нет

Возвращает число груп кэша. Является частью интерфеса Countable. Это значит вы
можете применять функцию `count()` к объекту класса кэширования.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void offsetSet(string $key, mixed $content)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

    -   **$content** - данные подлежащие кэшированию.

Модифицирует данные в кэше. При этом время жизни кэша и его группа остаются
неизменными. Если этот метод будет вызван для несуществующего кэша, то время
жизни кэша будет установленно равным значению внутренней переменной
`$vaultLifeTime`, а именем группы станет пустая строка. Метод является частью
интерфейса ArrayAccess.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public mixed offsetGet(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает данные сохранённые в кэше по их идентификатору. Метод является частью
интерфейса ArrayAccess.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public boolean offsetExists(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает TRUE, если время жизни кэша истекло и FALSE в противном случае. Метод
является частью интерфейса ArrayAccess.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void offsetUnset(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Удаляет данные из кэша по их идентификатору. Метод является частью интерфейса
ArrayAccess.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void __set(string $key, mixed $content)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

    -   **$content** - данные подлежащие кэшированию.

Модифицирует данные в кэше. При этом время жизни кэша и его группа остаются
неизменными. Если этот метод будет вызван для несуществующего кэша, то время
жизни кэша будет установленно равным значению внутренней переменной
`$vaultLifeTime`, а именем группы станет пустая строка.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public mixed __get(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает данные сохранённые в кэше по их идентификатору. Метод является частью
интерфейса ArrayAccess.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public boolean __isset(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Возвращает TRUE, если время жизни кэша истекло и FALSE в противном случае.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void __unset(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Удаляет данные из кэша по их идентификатору.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public array getVault()
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметр:** нет

Возвращает массив всех идентификаторов данных сохранённых в кэше.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public integer getVaultLifeTime()
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметр:** нет

Возвращает время жизни хранилища идентификаторов кэша, выраженное в секундах.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public integer setVaultLifeTime($vaultLifeTime)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметр:**

    -   **$vaultLifeTime** - время жизни хранилища в секундах.

Устанавливает время жизни хранилища идентификаторов кэша.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public array getByGroup(string $group = '')
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$group** - имя группы кэша.

Возвращает массив данных сохранённый в кэше под одной и той же заданной группой.
Пример:

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
// Записываем данные в кэш под группой 'my group'
foreach ($i = 1; $i <= 5; $i++) $cache->set('key' . $i, $i, 100, 'my group');
// Получаем массив данных кэша для группы 'my group'
print_r($cache->getByGroup('my group'));
// Получим массив вида 
// ['key1' => 1, 'key2' => 2, 'key3' => 3, 'key4' => 4, 'key5' => 5];
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
public void cleanByGroup(string $group = '')
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$group** - имя группы кэша.

Удаляет группу закэшированных данных по её имени.



Защищённые нестатические свойства
---------------------------------



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
protected integer $vaultLifeTime = 31536000
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Время жизни кэша идентификаторов кэшируемых данных. Время задаётся в секундах.



Защищённые нестатические методы
-------------------------------



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
protected void saveKey(string $key, integer $expire, string $group = '')
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

    -   **$expire** - время жизни кэша.

    -   **$group** - имя группы кэша.

Сохраняет идентификатор кэша в хранилище идентификаторов. Данный метод должен
вызываться в соотвествующей реализации абстрактного метода
`Aleph\Cache\Cache::set`.



~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
protected void removeKey(string $key)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Параметры:**

    -   **$key** - уникальный идентификатор кэшируемых данных.

Удаляет идентификатор кэша из хранилища идентификаторов. Данный метод должен
вызываться из соотвествующих реализаций абстрактных методов
`Aleph\Cache\Cache::get`, `Aleph\Cache\Cache::isExpired` и
`Aleph\Cache\Cache::clean`.



[1]: <http://php.net/manual/ru/memcache.addserver.php>
